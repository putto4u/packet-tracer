## 제9장: 계층적 이중화 네트워크 구축 실무 (HSRP 로드밸런싱)

본 장에서는 Core-Distribution-Access 계층 구조에서 **VLAN별 게이트웨이 이중화(HSRP)**를 통해 트래픽을 물리적으로 분산하고, 전체 노드가 상호 통신할 수 있는 상세 설정을 다룹니다.

---

### 1. 네트워크 주소 및 구성도 요약

* **Core L3:** 최상위 백본. PC1(`192.168.1.10`)이 연결됨.
* **Dist-A / Dist-B:** 중간 계층 L3 스위치. VLAN 10과 20의 게이트웨이 역할을 분담.
* **Access-L2:** 하단 PC2, PC3를 연결하며 상위로 트렁크(Trunk) 연결.
* **PC IP 정보:**
* **PC1:** `192.168.1.10/24` (GW: `192.168.1.1`)
* **PC2 (VLAN 10):** `192.168.10.10/24` (GW: `192.168.10.1`)
* **PC3 (VLAN 20):** `192.168.20.20/24` (GW: `192.168.20.1`)



---

### 2. 장비별 세부 CLI 설정

#### ① Core L3 스위치 (최상위)

PC1의 관문이며, 하단 VLAN 대역으로 가는 경로를 두 대의 Dist 스위치로 나누어 지정합니다.

```ios
hostname Core-L3
!
ip routing
!
interface GigabitEthernet0/1
 no switchport
 ip address 172.16.1.1 255.255.255.252  # 연결: Dist-A
!
interface GigabitEthernet0/2
 no switchport
 ip address 172.16.2.1 255.255.255.252  # 연결: Dist-B
!
interface GigabitEthernet0/3
 no switchport
 ip address 192.168.1.1 255.255.255.0    # PC1 게이트웨이
!
# 정적 라우팅: VLAN 10은 Dist-A로, VLAN 20은 Dist-B로 유도 (로드밸런싱)
ip route 192.168.10.0 255.255.255.0 172.16.1.2
ip route 192.168.20.0 255.255.255.0 172.16.2.2

```

---

#### ② Distribution L3 스위치 A (VLAN 10 Active)

VLAN 10 트래픽을 우선 처리하도록 HSRP 우선순위(Priority)를 높게 설정합니다.

```ios
hostname Dist-L3-A
!
ip routing
vlan 10
vlan 20
!
interface GigabitEthernet0/1
 no switchport
 ip address 172.16.1.2 255.255.255.252
!
interface GigabitEthernet0/2
 switchport mode trunk                   # 하단 Access-L2 연결
!
interface Vlan10
 ip address 192.168.10.2 255.255.255.0
 standby 10 ip 192.168.10.1
 standby 10 priority 110                  # VLAN 10의 대장
 standby 10 preempt                       # 자동회수
!
interface Vlan20
 ip address 192.168.20.2 255.255.255.0
 standby 20 ip 192.168.20.1
 standby 20 priority 100                  # VLAN 20의 후보
!
ip route 0.0.0.0 0.0.0.0 172.16.1.1      # 상위 Core로 향하는 기본 경로

```

---

#### ③ Distribution L3 스위치 B (VLAN 20 Active)

VLAN 20 트래픽을 우선 처리하도록 설정하여 Dist-A와 부하를 분산합니다.

```ios
hostname Dist-L3-B
!
ip routing
vlan 10
vlan 20
!
interface GigabitEthernet0/1
 no switchport
 ip address 172.16.2.2 255.255.255.252
!
interface GigabitEthernet0/2
 switchport mode trunk
!
interface Vlan10
 ip address 192.168.10.3 255.255.255.0
 standby 10 ip 192.168.10.1
 standby 10 priority 100
!
interface Vlan20
 ip address 192.168.20.3 255.255.255.0
 standby 20 ip 192.168.20.1
 standby 20 priority 110                  # VLAN 20의 대장
 standby 20 preempt
!
ip route 0.0.0.0 0.0.0.0 172.16.2.1

```

---

#### ④ Access L2 스위치 (액세스 계층)

VLAN을 선언하고 각 PC를 해당 포트에 할당합니다. 상위 연결은 모두 Trunk로 구성합니다.

```ios
hostname Access-L2
!
vlan 10
vlan 20
!
interface range GigabitEthernet0/1 - 2
 switchport mode trunk                   # Dist-A, Dist-B 연결
!
interface FastEthernet0/1
 switchport mode access
 switchport access vlan 10               # PC2 연결
!
interface FastEthernet0/2
 switchport mode access
 switchport access vlan 20               # PC3 연결

```

---

### 3. 기술 검증 포인트

1. **HSRP 역할 분담:** `show standby brief` 명령어를 통해 Dist-A가 VLAN 10에서 `Active`인지, Dist-B가 VLAN 20에서 `Active`인지 확인합니다.
2. **경로 추적 (Tracert):** * PC2에서 PC1 통신 시: 첫 번째 홉이 `192.168.10.2` (Dist-A)여야 함.
* PC3에서 PC1 통신 시: 첫 번째 홉이 `192.168.20.3` (Dist-B)여야 함.


3. **장애 복구:** Dist-A 스위치를 강제로 끄면, PC2의 트래픽이 즉시 Dist-B(`192.168.10.3`)를 통해 우회되는지 확인합니다.

---

**Next: 무선 LAN(WLAN) 구성과 WLC 기반 중앙 집중식 관리**

HSRP, VLAN Trunking, 정적 라우팅, 이중화, 부하 분산.
