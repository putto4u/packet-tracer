## 제19장: 인터넷 게이트웨이와 내부망 계층 구조 구성 실무

본 장에서는 인터넷(외부망)부터 최하단 PC까지 이어지는 전형적인 기업용 네트워크의 수직적 구조를 설계하고, 각 장비가 외부와 통신하기 위해 필요한 핵심 설정(NAT, Static Route, Access Port)을 다룹니다.

---

### 1. 네트워크 주소 설계 (IP Plan)

* **인터넷 ISP 구간:** 공인 IP 대역 (예: `211.1.1.0/30`)
* **라우터 ↔ L3 스위치:** 장비 간 연결 대역 (`172.16.1.0/30`)
* **내부망(VLAN 10):** 사무용 PC 대역 (`10.10.10.0/24`)

---

### 2. 장비별 세부 CLI 설정

#### ① 라우터 (Border Router)

인터넷 경계 장비로, 내부 사설 IP를 공인 IP로 변환하는 **NAT(Network Address Translation)**와 외부로 나가는 **기본 경로(Default Route)** 설정이 핵심입니다.

```ios
hostname Router
!
interface GigabitEthernet0/0
 ip address 211.1.1.2 255.255.255.252    # ISP 연결 (Outside)
 ip nat outside
!
interface GigabitEthernet0/1
 ip address 172.16.1.1 255.255.255.252    # L3 스위치 연결 (Inside)
 ip nat inside
!
# NAT 설정: 내부망(10.10.10.0)이 외부로 나갈 때 공인 IP 사용 허용
access-list 1 permit 10.10.10.0 0.0.0.255
ip nat inside source list 1 interface GigabitEthernet0/0 overload
!
# 라우팅: 외부(인터넷)로 나가는 경로와 내부망으로 들어오는 경로 지정
ip route 0.0.0.0 0.0.0.0 211.1.1.1        # ISP 방향
ip route 10.10.10.0 255.255.255.0 172.16.1.2  # 내부망 방향

```

---

#### ② L3 스위치 (Distribution/Core)

내부망의 게이트웨이(SVI) 역할을 수행하며, 모든 트래픽을 상위 라우터로 전달합니다.

```ios
hostname L3-Switch
!
ip routing
!
vlan 10
 name Office
!
interface GigabitEthernet0/1
 no switchport
 ip address 172.16.1.2 255.255.255.252    # 라우터 연결
!
interface Vlan10
 ip address 10.10.10.1 255.255.255.0      # PC의 게이트웨이
!
interface GigabitEthernet0/2
 switchport mode access
 switchport access vlan 10                # PC 연결 포트
!
# 모든 외부 트래픽을 라우터로 전달
ip route 0.0.0.0 0.0.0.0 172.16.1.1

```

---

#### ③ PC (End Device)

사용자 단말기에서는 수동 혹은 DHCP를 통해 IP를 설정합니다.

* **IP 주소:** `10.10.10.10`
* **서브넷 마스크:** `255.255.255.0`
* **기본 게이트웨이:** `10.10.10.1` (L3 스위치의 VLAN 10 IP)
* **DNS 서버:** `8.8.8.8` (Google DNS 등)

---

### 3. 실무 검증 포인트

1. **내부 통신 확인:** PC에서 L3 스위치 게이트웨이(`10.10.10.1`)로 핑 테스트.
2. **경계 통신 확인:** PC에서 라우터 내부 IP(`172.16.1.1`)로 핑 테스트.
3. **외부 통신 확인:** PC에서 인터넷 공인 IP 혹은 DNS(`8.8.8.8`)로 핑 테스트.
4. **NAT 확인:** 라우터에서 `show ip nat translations` 명령을 통해 사설 IP가 공인 IP로 변환되어 찍히는지 확인.

---

**Next: 내부망 자동 IP 할당을 위한 DHCP 서버 구성**

NAT, Default Route, SVI, Inside/Outside, Gateway 설정.
