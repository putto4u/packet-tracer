## 제24장: 엔터프라이즈 통합 OSPF 네트워크 - 전체 구성도 및 장비별 상세 설정

본 장에서는 **인터넷 - 라우터 - 방화벽 - 백본(2대) - 서버팜(2대) - 서버(4대)**로 이어지는 전체 인프라를 OSPF 동적 라우팅 프로토콜로 통합 구현합니다. 정적 라우팅 없이 네트워크가 스스로 경로를 계산하고 장애 시 우회하는 환경을 완성합니다.

---

### 1. 전체 구성 정보 및 IP 설계 (Total Info)

| 계층 | 장비명 | 연결 인터페이스 | 할당 IP / 서브넷 | OSPF Area |
| --- | --- | --- | --- | --- |
| **인터넷** | ISP | Router Gi0/0 연결 | 211.1.1.1/30 (공인) | - |
| **경계** | **Router** | Gi0/0(Ext), Gi0/1(Int) | 211.1.1.2/30, 10.0.0.1/30 | Area 0 |
| **보안** | **Firewall** | Gi0/0(Ext), Gi0/1(Int) | 10.0.0.2/30, 172.16.1.1/30 | Area 0 |
| **백본** | **Core-A** | Gi0/1(Up), Gi0/2(Down) | 172.16.1.2/30, 10.10.10.2/24 | Area 0, 10 |
| **백본** | **Core-B** | Gi0/1(Up), Gi0/2(Down) | 172.16.1.3/30, 10.10.20.2/24 | Area 0, 10 |
| **서버팜** | **Farm-A** | VLAN 10 (Server 1,2) | 10.10.10.1/24 (GW) | Area 10 |
| **서버팜** | **Farm-B** | VLAN 20 (Server 3,4) | 10.10.20.1/24 (GW) | Area 10 |

---

### 2. 장비별 OSPF 통합 설정 (Full CLI)

#### ① Border Router (Area 0)

외부 기본 경로를 OSPF 내부로 주입하는 원천 장비입니다.

```ios
hostname Router
!
interface Gi0/0
 ip address 211.1.1.2 255.255.255.252
 no shutdown
!
interface Gi0/1
 ip address 10.0.0.1 255.255.255.252
 no shutdown
!
router ospf 1
 router-id 1.1.1.1
 network 10.0.0.0 0.0.0.3 area 0
 default-information originate always     # 내부 장비들에게 인터넷 경로 전파

```

#### ② Firewall (Area 0)

보안 정책과 함께 인접성을 유지합니다. (Routed Mode 기준)

```ios
hostname Firewall
!
interface Gi0/0
 nameif outside
 ip address 10.0.0.2 255.255.255.252
 no shutdown
!
interface Gi0/1
 nameif inside
 ip address 172.16.1.1 255.255.255.252
 no shutdown
!
router ospf 1
 network 10.0.0.0 255.255.255.252 area 0
 network 172.16.1.0 255.255.255.252 area 0

```

#### ③ Backbone Switch (Core-A, B - ABR 역할)

상위 Area 0와 하위 Area 10을 연결합니다.

```ios
# Core-A 설정 (Core-B는 IP 및 RID만 변경)
hostname Core-A
ip routing
!
interface Gi0/1 (To FW)
 no switchport
 ip address 172.16.1.2 255.255.255.252
 no shutdown
!
router ospf 1
 router-id 2.2.2.2
 network 172.16.1.0 0.0.0.3 area 0
 network 10.10.10.0 0.0.0.255 area 10
 network 10.10.20.0 0.0.0.255 area 10

```

#### ④ Server Farm Switch (Farm-A, B)

실제 서버들이 연결된 대역을 광고합니다.

```ios
# Farm-A 설정
hostname Farm-A
ip routing
vlan 10
!
interface Vlan 10
 ip address 10.10.10.1 255.255.255.0
 no shutdown
!
router ospf 1
 router-id 10.10.10.10
 network 10.10.10.0 0.0.0.255 area 10
 passive-interface Vlan 10                # 서버 쪽으로는 OSPF 패킷 차단(보안)

```

---

### 3. 실습 과제: OSPF 계층 구조 분석

**[과제 1] 라우팅 테이블 확인**
**문제:** 서버팜 스위치에서 외부 인터넷 경로(`0.0.0.0/0`)를 학습했는지 확인하는 명령어와 테이블상의 표기 형식을 쓰시오.
**모범 답안:** `show ip route` 명령 사용 시, `O*E2 0.0.0.0/0 [110/1] via ...` 형식으로 나타납니다.

**[과제 2] Area 분리의 이유**
**문제:** 전체를 Area 0 하나로 만들지 않고 Area 10을 별도로 구성했을 때의 장점을 서술하시오.
**모범 답안:** 특정 Area의 네트워크 변화(LSA 발생)가 다른 Area로 전파되는 것을 억제하여, 대규모 망에서 라우터의 CPU 부하를 줄이고 안정성을 높일 수 있습니다.

**[과제 3] 넥스트 홉(Next-Hop) 추적**
**문제:** 서버 1(`10.10.10.10`)에서 외부로 나가는 패킷의 경로를 단계별로 나열하시오.
**모범 답안:** 서버 1 → Farm-A → Core-A/B(ECMP 로드밸런싱) → Firewall → Router → ISP.

---

### 4. 핵심 단어 요약

* **Area 0 (Backbone):** 모든 Area의 중심축.
* **ABR (Area Border Router):** 둘 이상의 Area에 걸쳐 있는 라우터 (여기서는 Core 스위치).
* **ASBR (Autonomous System Boundary Router):** 외부망(인터넷)과 OSPF망을 잇는 라우터.
* **Passive-Interface:** 라우팅 업데이트가 필요 없는 사용자 포트의 보안 설정.

---

**Next: 네트워크 가상화 기술(VRF)을 이용한 망 분리**

OSPF Area 0, ABR, ASBR, O*E2 Route, Passive Interface.
