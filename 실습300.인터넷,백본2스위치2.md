## 제22장: 엔터프라이즈 데이터센터 네트워크 구축 (보안 및 고가용성 설계)

본 장에서는 보안(Firewall)과 이중화(High Availability)가 결합된 표준 기업용 네트워크 아키텍처를 다룹니다. 인터넷 관문부터 서버팜(Server Farm)까지의 트래픽 흐름을 최적화하고 장애 대비 능력을 극대화하는 설정을 구현합니다.

---

### 1. 네트워크 물리적/논리적 아키텍처

* **외부 구간:** ISP ↔ **Router** (경계 라우팅 & NAT)
* **보안 구간:** Router ↔ **Firewall** (상태 기반 패킷 검사 & DMZ 분리)
* **백본 구간:** Firewall ↔ **Core L3 Switch 2대** (VPC/VSS 또는 HSRP를 통한 게이트웨이 이중화)
* **서버팜 구간:** Core ↔ **Server Farm L3 Switch 2대** (VLAN 10, 20 운영 및 로드밸런싱)
* **서비스 구간:** 서버 4대 (VLAN 10에 2대, VLAN 20에 2대 배치)

---

### 2. 장비별 세부 설정 가이드

#### ① Border Router (경계 라우터)

외부 ISP와의 통신 및 내부 사설 대역을 위한 기본 경로를 설정합니다.

```ios
hostname Border-Router
!
interface Gi0/0 (Outside)
 ip address 211.1.1.2 255.255.255.252
 no shutdown
!
interface Gi0/1 (To Firewall)
 ip address 10.0.0.1 255.255.255.252
 no shutdown
!
ip route 0.0.0.0 0.0.0.0 211.1.1.1
ip route 10.10.0.0 255.255.0.0 10.0.0.2  # 내부망 전체를 방화벽으로 전달

```

#### ② Firewall (방화벽 - ASA/NGFW 기준)

내부와 외부 사이의 보안 정책을 수립합니다.

```ios
interface Gi0/0 (Outside)
 nameif outside
 security-level 0
 ip address 10.0.0.2 255.255.255.252
!
interface Gi0/1 (Inside)
 nameif inside
 security-level 100
 ip address 172.16.1.1 255.255.255.252
!
# 보안 정책: 내부에서 외부로 나가는 트래픽 허용
access-list OUTBOUND extended permit ip any any
access-group OUTBOUND in interface inside
nat (inside,outside) after-auto source dynamic any interface

```

#### ③ Backbone 스위치 (Core-L3-A/B)

HSRP를 사용하여 서버팜의 게이트웨이 이중화를 수행합니다.

```ios
# Core-A 설정 (VLAN 10 Active)
hostname Core-A
ip routing
interface Vlan 10
 ip address 10.10.10.2 255.255.255.0
 standby 10 ip 10.10.10.1
 standby 10 priority 110
 standby 10 preempt
interface Vlan 20
 ip address 10.10.20.2 255.255.255.0
 standby 20 ip 10.10.20.1
 standby 20 priority 100

```

#### ④ 서버팜 스위치 (Server-Farm-A/B)

L2 트렁크를 통해 서버 트래픽을 백본으로 전달하며, EtherChannel로 대역폭을 확장합니다.

```ios
# Server-Farm-A 설정
hostname Farm-A
vlan 10,20
interface range Gi0/1 - 2
 channel-group 1 mode active       # 백본과의 이더채널 구성
 switchport mode trunk
interface Gi0/10 (To Server 1)
 switchport access vlan 10

```

---

### 3. 실습 과제: 장애 복구 및 트래픽 분산 검증

**[과제 1] 서버팜 로드밸런싱 확인**
**문제:** VLAN 10 소속 서버와 VLAN 20 소속 서버가 각각 다른 백본 스위치를 통해 외부로 나가는지 `tracert`로 확인하시오.
**모범 답안:** VLAN 10은 Core-A(110)를, VLAN 20은 Core-B(110)를 각각 Active 게이트웨이로 바라보도록 우선순위가 설정되어 있어야 합니다.

**[과제 2] 방화벽 이중화의 필요성**
**문제:** 현재 구성에서 방화벽이 1대일 경우 발생하는 **SPOF(단일 장애점)** 문제를 설명하시오.
**모범 답안:** 라우터와 백본이 이중화되어 있어도 중간 경로인 방화벽에 장애가 발생하면 전체 서비스가 중단됩니다. 따라서 실무에서는 방화벽도 **Active-Standby**로 2대 구성해야 합니다.

**[과제 3] 헬스 체크 설정**
**문제:** L3 스위치에서 상위 방화벽의 가용성을 체크하여 경로를 자동 전환하는 기능을 무엇이라 하는가?
**모범 답안:** **IP SLA (Service Level Agreement)** 및 **Track** 기능을 사용하여 특정 IP로 핑이 안 나갈 경우 HSRP 우선순위를 자동으로 낮추도록 설정합니다.

---

### 4. 핵심 단어 요약

* **SPOF:** 단일 장애점.
* **DMZ:** 외부에서 접근 가능한 격리된 내부 구역.
* **HSRP Tracking:** 상위 링크 장애 시 우선순위를 자동 조정하는 기능.
* **EtherChannel:** 물리적 포트를 묶어 논리적 대역폭을 확장하는 기술.

---

**Next: 클라우드 연동을 위한 하이브리드 클라우드 VPN 구성**

HSRP, Firewall Security, SPOF 제거, IP SLA, EtherChannel.
