## AWS 하이브리드 클라우드 연동을 위한 최종 표준 네트워크 설계


<img width="1298" height="833" alt="image" src="https://github.com/user-attachments/assets/2f288d07-e77e-47a3-b706-87aaa6dba524" />



업로드하신 마지막 이미지(`image_5f2424.png`)는 각 장비 간의 연결 구간을 독립된 서브넷으로 완벽히 분리하면서도, 3단계 계층 구조(Core-Distribution-Access)에 맞는 일관된 IP 규칙을 적용한 최적의 설계입니다. 이 구성은 향후 AWS Site-to-Site VPN을 통해 온프레미스와 클라우드를 연결할 때 라우팅 경로를 가장 명확하게 제어할 수 있는 구조입니다.

---

## 1. 표준 네트워크 IP 주소 할당표

모든 사설 구간은 AWS VPC 기본 대역과의 충돌을 피하기 위해 `172.16.0.0/12` 범위 내에서 **24-bit(/24)** 단위로 설계되었습니다.

| 구분 | 장비/인터페이스 | IP 주소 / Subnet | 연결 대상 및 목적 |
| --- | --- | --- | --- |
| **외부 인터넷** | Router0 Gi0/0 | **111.111.111.2/30** | ISP 1 (Primary Public Link) |
|  | Router1 Gi0/0 | **222.222.222.2/30** | ISP 2 (Secondary Public Link) |
| **백본 연결** | Router0 ↔ SW0 | 172.16.1.1 ↔ 1.2 /24 | 내부 라우팅 경로 A |
|  | Router0 ↔ SW1 | 172.16.4.1 ↔ 4.2 /24 | 내부 라우팅 경로 B |
|  | Router1 ↔ SW0 | 172.16.3.1 ↔ 3.2 /24 | 내부 라우팅 경로 C |
|  | Router1 ↔ SW1 | 172.16.2.1 ↔ 2.2 /24 | 내부 라우팅 경로 D |
| **내부 사용자** | **Vlan 10 가상 GW** | **172.16.10.1/24** | **HSRP 로드밸런싱 게이트웨이** |
|  | SW0 Vlan 10 | 172.16.10.2/24 | SW0용 인터페이스 IP |
|  | SW1 Vlan 10 | 172.16.10.3/24 | SW1용 인터페이스 IP |

---

## 2. 장비별 최종 CLI 설정 파일

### Router0 (ISP 1 서비스 및 외부 게이트웨이)

```bash
hostname Router0
!
interface GigabitEthernet0/0
 description OUTSIDE_ISP1
 ip address 111.111.111.2 255.255.255.252
 ip nat outside
!
interface GigabitEthernet0/1
 ip address 172.16.1.1 255.255.255.0
 ip nat inside
!
interface GigabitEthernet0/2
 ip address 172.16.4.1 255.255.255.0
 ip nat inside
!
router ospf 1
 network 172.16.1.0 0.0.0.255 area 0
 network 172.16.4.0 0.0.0.255 area 0
 default-information originate
!
ip route 0.0.0.0 0.0.0.0 111.111.111.1
ip nat inside source list 1 interface GigabitEthernet0/0 overload
access-list 1 permit 172.16.10.0 0.0.0.255

```

### Router1 (ISP 2 서비스 및 로드밸런싱)

```bash
hostname Router1
!
interface GigabitEthernet0/0
 description OUTSIDE_ISP2
 ip address 222.222.222.2 255.255.255.252
 ip nat outside
!
interface GigabitEthernet0/1
 ip address 172.16.3.1 255.255.255.0
 ip nat inside
!
interface GigabitEthernet0/2
 ip address 172.16.2.1 255.255.255.0
 ip nat inside
!
router ospf 1
 network 172.16.3.0 0.0.0.255 area 0
 network 172.16.2.0 0.0.0.255 area 0
 default-information originate
!
ip route 0.0.0.0 0.0.0.0 222.222.222.1
ip nat inside source list 1 interface GigabitEthernet0/0 overload
access-list 1 permit 172.16.10.0 0.0.0.255

```

### Multilayer Switch 0 (SW0 - VLAN 10 Active)

```bash
hostname SW0
!
ip routing
!
interface GigabitEthernet0/1
 no switchport
 ip address 172.16.1.2 255.255.255.0
!
interface GigabitEthernet0/2
 no switchport
 ip address 172.16.3.2 255.255.255.0
!
interface Vlan 10
 ip address 172.16.10.2 255.255.255.0
 standby 10 ip 172.16.10.1
 standby 10 priority 110
 standby 10 preempt
!
router ospf 1
 network 172.16.1.0 0.0.0.255 area 0
 network 172.16.3.0 0.0.0.255 area 0
 network 172.16.10.0 0.0.0.255 area 0

```

### Multilayer Switch 1 (SW1 - VLAN 10 Standby)

```bash
hostname SW1
!
ip routing
!
interface GigabitEthernet0/1
 no switchport
 ip address 172.16.4.2 255.255.255.0
!
interface GigabitEthernet0/2
 no switchport
 ip address 172.16.2.2 255.255.255.0
!
interface Vlan 10
 ip address 172.16.10.3 255.255.255.0
 standby 10 ip 172.16.10.1
 standby 10 priority 100
 standby 10 preempt
!
router ospf 1
 network 172.16.4.0 0.0.0.255 area 0
 network 172.16.2.0 0.0.0.255 area 0
 network 172.16.10.0 0.0.0.255 area 0

```

---

## 3. 설계의 일관성 및 로드밸런싱 메커니즘

1. **동적 라우팅 (OSPF ECMP)**: L3 스위치(SW0, SW1)는 `172.16.1.0`~`4.0` 대역을 통해 두 라우터로 향하는 모든 경로를 학습합니다. OSPF는 동일 비용 경로를 자동으로 활용하여 트래픽을 분산시킵니다.
2. **게이트웨이 이중화 (HSRP)**: 하단 Access Switch(Switch0)에 연결된 PC들은 `172.16.10.1`을 게이트웨이로 사용합니다. SW0이 우선권을 가지며, 장애 시 SW1이 즉시 트래픽을 인계받습니다.
3. **AWS 연동 준비**: `10.x.x.x` 대역을 전혀 사용하지 않으므로, AWS VPC 생성 시 가장 대중적인 `10.0.0.0/16` 대역을 그대로 사용할 수 있어 하이브리드 클라우드 구축이 매우 용이합니다.

> **[AWS 과금 안내]**
> * **VPN 비용:** AWS Site-to-Site VPN 운영 시 시간당 약 **$0.05**의 연결 요금이 발생합니다. (터널당 과금)
> * **데이터 전송:** AWS에서 인터넷 또는 온프레미스로 나가는 트래픽에 대해 GB당 과금되므로, 대규모 데이터 마이그레이션 시 비용을 사전에 검토하시기 바랍니다.
> 
> 

---

Next Level : AWS Site-to-Site VPN 터널 생성 및 BGP 라우팅 검증

HSRP 로드밸런싱, OSPF ECMP, 24bit IP 일관성 규칙, AWS 하이브리드 클라우드 설계 완료
