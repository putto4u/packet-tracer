# 인터넷 2중화-클라우드 사용

<img width="2485" height="1182" alt="image" src="https://github.com/user-attachments/assets/1a08f4af-4f33-4d2b-870b-2d23c6db4dd8" />



## 엔터프라이즈 이중화 백본 네트워크 설계 (Enterprise Redundant Backbone Network Design)

본 장에서는 제안된 최종 네트워크 토폴로지를 기반으로 고가용성(High Availability)과 로드 밸런싱을 고려한 엔터프라이즈급 네트워크 구성을 다룹니다. 특히 물리적/논리적으로 이중화된 백본 스위치(L3 Switch)의 장비별 독립적인 설정 과정을 상세히 명세합니다.

> **AWS 클라우드 연동 주의사항**:
> 본 설계에 포함된 AWS 클라우드 연결(10.x.x.x 대역)을 실제로 구현할 경우, AWS VPC, VPN Gateway, Direct Connect 등의 리소스 사용에 따라 **비용이 청구(Billable)**됩니다. 실습 전 프리 티어 적용 여부 및 과금 정책을 반드시 확인해야 합니다.

---

### 1. 네트워크 구성 개요 및 특징

이 토폴로지는 단일 실패 지점(SPOF)을 제거하고, 본사(HQ)와 지사(Branch), 그리고 클라우드(AWS) 구간을 유기적으로 연결하도록 설계되었습니다.

1. **WAN 이중화**:
* ISP 1(111.xxx)과 ISP 2(222.xxx)를 통해 서로 다른 경로로 인터넷/외부망에 연결하여 회선 장애에 대비합니다.


2. **Core/Distribution Layer (백본 이중화)**:
* `Multilayer Switch0`과 `Multilayer Switch1`이 핵심 백본 역할을 수행합니다.
* 두 스위치는 **FHRP(HSRP/VRRP)** 프로토콜을 통해 게이트웨이 이중화를 제공하며, 내부 사용자(VLAN 10, 20 등)에게 끊김 없는 네트워크를 제공합니다.


3. **Transit Routing**:
* `Router4`와 `Router6`을 통해 지사(Branch) 네트워크(192.170.x.x)와 백본 간의 라우팅을 중계합니다.


4. **Security & Cloud Policy**:
* AWS와의 연동을 고려하여 내부망은 공인 IP와 충돌하지 않는 사설 IP 대역(172.16.x.x, 192.168.x.x)을 사용하며, AWS VPC 대역(10.x.x.x)을 별도로 예약합니다.



---

### 2. 장비별 상세 IP 구성 목록 (Network Configuration List)

아래 표는 토폴로지 다이어그램에 명시된 연결 정보를 기반으로 한 인터페이스 및 IP 할당 내역입니다.

#### A. WAN & Core Layer (본사)

| 장비명 (Device) | 인터페이스 (Interface) | IP 주소 (IP Address/Subnet) | 설명 (Description) |
| --- | --- | --- | --- |
| **Router3** | G0/0 (WAN) | 111.111.111.2 /30 | ISP 1 연결 (Cloud-PT) |
|  | G0/1 (LAN) | 172.16.1.1 /24 | Backbone 0 연결 |
| **Router(2)** | G0/0 (WAN) | 222.222.222.2 /30 | ISP 2 연결 (Cloud-PT) |
|  | G0/1 (LAN) | 172.16.2.1 /24 | Backbone 1 연결 |
| **MultiLayer Switch0**<br>

<br>(Backbone 1 / Active) | Routed Port 1 | 172.16.1.2 /24 | Router3 업링크 |
|  | Routed Port 2 | 172.16.3.2 /24 | Switch13 연결 |
|  | Routed Port 3 | 172.16.5.2 /24 | Router4 연결 |
|  | **VLAN 10 (SVI)** | **192.168.10.2 /24** | 내부망 게이트웨이 (Physical) |
|  | **VLAN 10 (VIP)** | **192.168.10.1 /24** | **HSRP 가상 게이트웨이** |
| **MultiLayer Switch1**<br>

<br>(Backbone 2 / Standby) | Routed Port 1 | 172.16.2.2 /24 | Router(2) 업링크 |
|  | Routed Port 2 | 172.16.4.2 /24 | Switch13 연결 |
|  | Routed Port 3 | 172.16.6.2 /24 | Router4 연결 |
|  | **VLAN 10 (SVI)** | **192.168.10.3 /24** | 내부망 게이트웨이 (Physical) |
|  | **VLAN 10 (VIP)** | **192.168.10.1 /24** | **HSRP 가상 게이트웨이** |

#### B. Distribution & Access Layer (지사 및 내부망)

| 장비명 (Device) | 인터페이스 | IP 주소 (IP Address/Subnet) | 설명 |
| --- | --- | --- | --- |
| **Switch13** | Uplink 1 | 172.16.3.1 /30 | Backbone 0 연결 |
|  | Uplink 2 | 172.16.4.1 /24 | Backbone 1 연결 |
| **Router4** | G0/0 | 172.16.5.1 /24 | Backbone 0 다운링크 |
|  | G0/1 | 172.16.6.1 /24 | Backbone 1 다운링크 |
|  | G0/2 | 172.16.7.2 /24 | Router6 연결 |
| **Router6** | G0/0 | 172.16.7.1 /24 | Router4 업링크 |
|  | G0/1 | 172.16.8.1 /24 | Right-Side Switch7 연결 |
| **MultiLayer Switch7** | Uplink | 172.16.8.2 /24 | Router6 연결 |
|  | VLAN 150 | 192.170.150.1 /24 | 지사 내부망 게이트웨이 |

---

### 3. 이중화 백본 장비별 상세 설정 (Detailed Configuration per Backbone Device)

백본 스위치의 설정은 **Active(Switch0)**와 **Standby(Switch1)**로 명확히 구분됩니다. 각 장비에 접속하여 아래 설정을 순차적으로 적용합니다.

#### A. Multilayer Switch0 (Active Backbone) 설정

이 장비는 **HSRP Priority 110**을 부여하여 평상시 주(Active) 경로로 동작합니다.

```bash
Switch> enable
Switch# configure terminal
Switch(config)# hostname Backbone-Active

! 1. 라우팅 기능 활성화
Backbone-Active(config)# ip routing

! 2. VLAN 생성
Backbone-Active(config)# vlan 10
Backbone-Active(config-vlan)# name Sales_Dept
Backbone-Active(config-vlan)# exit

! 3. L3 인터페이스 설정 (업링크 - Router3 연결)
Backbone-Active(config)# interface GigabitEthernet 1/0/1
Backbone-Active(config-if)# no switchport
Backbone-Active(config-if)# ip address 172.16.1.2 255.255.255.0
Backbone-Active(config-if)# no shutdown
Backbone-Active(config-if)# exit

! 4. L3 인터페이스 설정 (다운링크 - Switch13 연결)
Backbone-Active(config)# interface GigabitEthernet 1/0/2
Backbone-Active(config-if)# no switchport
Backbone-Active(config-if)# ip address 172.16.3.2 255.255.255.0
Backbone-Active(config-if)# no shutdown
Backbone-Active(config-if)# exit

! 5. L3 인터페이스 설정 (다운링크 - Router4 연결)
Backbone-Active(config)# interface GigabitEthernet 1/0/3
Backbone-Active(config-if)# no switchport
Backbone-Active(config-if)# ip address 172.16.5.2 255.255.255.0
Backbone-Active(config-if)# no shutdown
Backbone-Active(config-if)# exit

! 6. SVI (VLAN 인터페이스) 및 HSRP Active 설정 (Priority 110)
Backbone-Active(config)# interface vlan 10
Backbone-Active(config-if)# ip address 192.168.10.2 255.255.255.0
Backbone-Active(config-if)# standby 1 ip 192.168.10.1       ! 가상 게이트웨이 IP
Backbone-Active(config-if)# standby 1 priority 110          ! 우선순위 110 (높음)
Backbone-Active(config-if)# standby 1 preempt               ! 복구 시 Active 권한 회수
Backbone-Active(config-if)# no shutdown
Backbone-Active(config-if)# exit

! 7. OSPF 라우팅 설정
Backbone-Active(config)# router ospf 1
Backbone-Active(config-router)# router-id 1.1.1.1
Backbone-Active(config-router)# network 172.16.1.0 0.0.0.255 area 0
Backbone-Active(config-router)# network 172.16.3.0 0.0.0.255 area 0
Backbone-Active(config-router)# network 172.16.5.0 0.0.0.255 area 0
Backbone-Active(config-router)# network 192.168.10.0 0.0.0.255 area 0

```

#### B. Multilayer Switch1 (Standby Backbone) 설정

이 장비는 **HSRP Priority 100(기본값)**을 유지하여 평상시 대기(Standby) 상태로 동작하며, Active 장비 장애 시 즉시 역할을 수행합니다.

```bash
Switch> enable
Switch# configure terminal
Switch(config)# hostname Backbone-Standby

! 1. 라우팅 기능 활성화
Backbone-Standby(config)# ip routing

! 2. VLAN 생성
Backbone-Standby(config)# vlan 10
Backbone-Standby(config-vlan)# name Sales_Dept
Backbone-Standby(config-vlan)# exit

! 3. L3 인터페이스 설정 (업링크 - Router2 연결)
Backbone-Standby(config)# interface GigabitEthernet 1/0/1
Backbone-Standby(config-if)# no switchport
Backbone-Standby(config-if)# ip address 172.16.2.2 255.255.255.0
Backbone-Standby(config-if)# no shutdown
Backbone-Standby(config-if)# exit

! 4. L3 인터페이스 설정 (다운링크 - Switch13 연결)
Backbone-Standby(config)# interface GigabitEthernet 1/0/2
Backbone-Standby(config-if)# no switchport
Backbone-Standby(config-if)# ip address 172.16.4.2 255.255.255.0
Backbone-Standby(config-if)# no shutdown
Backbone-Standby(config-if)# exit

! 5. L3 인터페이스 설정 (다운링크 - Router4 연결)
Backbone-Standby(config)# interface GigabitEthernet 1/0/3
Backbone-Standby(config-if)# no switchport
Backbone-Standby(config-if)# ip address 172.16.6.2 255.255.255.0
Backbone-Standby(config-if)# no shutdown
Backbone-Standby(config-if)# exit

! 6. SVI (VLAN 인터페이스) 및 HSRP Standby 설정 (Priority 100)
Backbone-Standby(config)# interface vlan 10
Backbone-Standby(config-if)# ip address 192.168.10.3 255.255.255.0
Backbone-Standby(config-if)# standby 1 ip 192.168.10.1       ! 동일한 가상 게이트웨이 IP
Backbone-Standby(config-if)# standby 1 priority 100          ! 우선순위 100 (기본값)
Backbone-Standby(config-if)# standby 1 preempt               ! Preempt 활성화
Backbone-Standby(config-if)# no shutdown
Backbone-Standby(config-if)# exit

! 7. OSPF 라우팅 설정
Backbone-Standby(config)# router ospf 1
Backbone-Standby(config-router)# router-id 2.2.2.2
Backbone-Standby(config-router)# network 172.16.2.0 0.0.0.255 area 0
Backbone-Standby(config-router)# network 172.16.4.0 0.0.0.255 area 0
Backbone-Standby(config-router)# network 172.16.6.0 0.0.0.255 area 0
Backbone-Standby(config-router)# network 192.168.10.0 0.0.0.255 area 0

```

---

**Next Level :** AWS VPC 연동을 위한 Site-to-Site VPN 구성 및 BGP 라우팅 설정
